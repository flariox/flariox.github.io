<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Blog oficial de Flariox: novedades, tutoriales y comunidad." />
  <title>Flariox | Blog</title>

  <!-- Estilos -->
  <link rel="stylesheet" href="./assets/webfonts/css/all.css" />
  <link rel="stylesheet" href="./assets/css/styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>

  <!-- Header -->
  <header class="main-header">
    <nav class="navbar">
      <a href="index.html" class="logo">
        <img src="./assets/images/logo/logo.png" alt="Flariox" class="logo-img" />
        Flariox
      </a>
      <button class="sidebar-toggle" aria-expanded="false" aria-controls="sidebar">
        <i class="fas fa-bars"></i>
      </button>
      <ul class="nav-list">
        <li><a href="index.html#about" class="nav-link">Acerca de</a></li>
        <li><a href="index.html#features" class="nav-link">Características</a></li>
        <li><a href="index.html#download" class="nav-link">Descargar</a></li>
        <li><a href="blog.html" class="nav-link active">Blog</a></li>
      </ul>
    </nav>
  </header>

  <!-- Sidebar -->
  <div class="sidebar-overlay"></div>
  <aside id="sidebar" class="sidebar" aria-hidden="true">
    <button class="close-sidebar"><i class="fas fa-times"></i></button>
    <nav class="sidebar-nav">
      <ul class="sidebar-list">
        <li><a href="index.html#about" class="sidebar-link">Acerca de</a></li>
        <li><a href="index.html#features" class="sidebar-link">Características</a></li>
        <li><a href="index.html#download" class="sidebar-link">Descargar</a></li>
        <li><a href="blog.html" class="sidebar-link active">Blog</a></li>
      </ul>
    </nav>
  </aside>

  <!-- Contenido del Blog -->
  <main>
    <section class="section" id="blog">
      <div class="container">
        <h1 class="section-title">Blog de Flariox</h1>
        <p class="section-subtitle">Novedades, guías y contribuciones de la comunidad.</p>

        <div id="blog-cards" class="blog-card-grid"></div>
        <div id="blog-content" class="article-content" style="display: none;"></div>
      </div>
    </section>
  </main>

  <!-- Pie de página -->
  <footer class="main-footer">
    <div class="container">
      <div class="footer-grid">
        <!-- footer-about, footer-links, footer-resources, footer-legal idénticos al index.html -->
        <!-- Puedes copiar tu footer completo aquí -->
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 Flariox. Todos los derechos reservados.</p>
        <p>Flariox ® es una marca registrada de Flariox Community.</p>
      </div>
    </div>
  </footer>

  <!-- Botón flotante de Telegram -->
  <a href="https://t.me/flariox" class="telegram-float" target="_blank" rel="noopener noreferrer">
    <i class="fab fa-telegram-plane"></i>
  </a>

  <!-- Banner de cookies -->
  <div id="cookie-banner" class="cookie-banner" aria-hidden="true">
    <p>Este sitio utiliza cookies para mejorar tu experiencia. <a href="#">Saber más</a></p>
    <button id="accept-cookies" class="accept-button">Aceptar</button>
  </div>

  <!-- Scripts -->
  <script src="./assets/js/main.js"></script>

  <!-- Blog dinámico -->
  <script>
    const repoOwner = 'TUNOMBREUSUARIO'; // ← Reemplaza por tu usuario
    const repoName = 'NOMBREDELREPO';   // ← Reemplaza por tu repo
    const branch = 'main';              // o 'master'

    const articles = [
      { file: 'bienvenido.md', title: 'Bienvenido a Flariox', description: 'Presentación del proyecto y primeros pasos.' },
      { file: 'instalacion.md', title: 'Guía de Instalación', description: 'Aprende a instalar Flariox paso a paso.' },
      { file: 'personaliza.md', title: 'Personaliza tu Escritorio', description: 'Tips de personalización visual en Flariox.' }
    ];

    const blogContainer = document.getElementById('blog-cards');
    const blogContent = document.getElementById('blog-content');

    function formatDate(iso) {
      return new Date(iso).toLocaleDateString('es-ES', { year: 'numeric', month: 'long', day: 'numeric' });
    }

    function renderCard({ file, title, description, date }) {
      const card = document.createElement('div');
      card.className = 'blog-card';
      card.innerHTML = `
        <h3>${title}</h3>
        <p>${description}</p>
        <p class="date">Última actualización: ${date || 'Cargando...'}</p>
      `;
      card.onclick = () => loadArticle(file);
      blogContainer.appendChild(card);
    }

    function loadArticle(file) {
      fetch(`./articles/${file}`)
        .then(r => r.ok ? r.text() : Promise.reject())
        .then(md => {
          blogContainer.style.display = 'none';
          blogContent.innerHTML = marked.parse(md);
          blogContent.style.display = 'block';
          window.scrollTo({ top: blogContent.offsetTop, behavior: 'smooth' });
        });
    }

    async function fetchGitHubDate(filePath) {
      const url = `https://api.github.com/repos/${repoOwner}/${repoName}/commits?path=articles/${filePath}&sha=${branch}&per_page=1`;
      const res = await fetch(url);
      const data = await res.json();
      return formatDate(data[0]?.commit?.committer?.date || new Date());
    }

    (async () => {
      for (const article of articles) {
        renderCard({ ...article, date: '...' });
        const date = await fetchGitHubDate(article.file);
        const lastCard = blogContainer.lastElementChild;
        lastCard.querySelector('.date').textContent = `Última actualización: ${date}`;
      }
    })();
  </script>

  <!-- Estilos para blog -->
  <style>
    .blog-card-grid {
      display: grid;
      gap: 2rem;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      margin-top: 2rem;
    }

    .blog-card {
      background: var(--bg-color, #1a1a1a);
      border: 1px solid var(--accent-color, #0af);
      padding: 1.5rem;
      border-radius: 10px;
      transition: transform 0.3s ease;
      cursor: pointer;
    }

    .blog-card:hover {
      transform: translateY(-4px);
    }

    .blog-card h3 {
      margin-top: 0;
      font-size: 1.3rem;
      color: var(--accent-color, #0af);
    }

    .blog-card p {
      margin-bottom: 0.4rem;
      line-height: 1.6;
    }

    .blog-card .date {
      font-size: 0.8rem;
      opacity: 0.6;
    }

    .article-content {
      max-width: 800px;
      margin: 4rem auto 2rem;
      padding: 1rem;
    }

    .article-content h1, .article-content h2, .article-content h3 {
      color: var(--accent-color, #0af);
    }

    .article-content p {
      line-height: 1.8;
      margin-bottom: 1rem;
    }
  </style>
</body>
</html>

